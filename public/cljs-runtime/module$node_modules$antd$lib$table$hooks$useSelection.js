shadow$provide.module$node_modules$antd$lib$table$hooks$useSelection=function(global,require,module,exports){function getFixedType(column){return column&&column.fixed}function flattenData(data,childrenColumnName){var list=[];(data||[]).forEach(function(record){list.push(record);record&&"object"===(0,_typeof2["default"])(record)&&childrenColumnName in record&&(list=[].concat((0,_toConsumableArray2["default"])(list),(0,_toConsumableArray2["default"])(flattenData(record[childrenColumnName],childrenColumnName))))});
return list}global=require("module$node_modules$$babel$runtime$helpers$interopRequireWildcard");module=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=function(rowSelection,config){var _ref=rowSelection||{},preserveSelectedRowKeys=_ref.preserveSelectedRowKeys,selectedRowKeys=_ref.selectedRowKeys,defaultSelectedRowKeys=_ref.defaultSelectedRowKeys,getCheckboxProps=_ref.getCheckboxProps,onSelectionChange=
_ref.onChange,onSelect=_ref.onSelect,onSelectAll=_ref.onSelectAll,onSelectInvert=_ref.onSelectInvert,onSelectNone=_ref.onSelectNone,onSelectMultiple=_ref.onSelectMultiple,selectionColWidth=_ref.columnWidth,selectionType=_ref.type,selections=_ref.selections,fixed=_ref.fixed,customizeRenderCell=_ref.renderCell,hideSelectAll=_ref.hideSelectAll;_ref=_ref.checkStrictly;var checkStrictly=void 0===_ref?!0:_ref,prefixCls=config.prefixCls,data=config.data,pageData=config.pageData,getRecordByKey=config.getRecordByKey,
getRowKey=config.getRowKey,expandType=config.expandType,childrenColumnName=config.childrenColumnName,tableLocale=config.locale,expandIconColumnIndex=config.expandIconColumnIndex,getPopupContainer=config.getPopupContainer,preserveRecordsRef=React.useRef(new Map);config=(0,_useMergedState3["default"])(selectedRowKeys||defaultSelectedRowKeys||[],{value:selectedRowKeys});config=(0,_slicedToArray2["default"])(config,2);var mergedSelectedKeys=config[0],setMergedSelectedKeys=config[1],keyEntities=(0,React.useMemo)(function(){return checkStrictly?
{keyEntities:null}:(0,_treeUtil.convertDataToEntities)(data,{externalGetKey:getRowKey,childrenPropName:childrenColumnName})},[data,getRowKey,checkStrictly,childrenColumnName]).keyEntities,flattedData=(0,React.useMemo)(function(){return flattenData(pageData,childrenColumnName)},[pageData,childrenColumnName]),checkboxPropsMap=(0,React.useMemo)(function(){var map=new Map;flattedData.forEach(function(record,index){index=getRowKey(record,index);record=(getCheckboxProps?getCheckboxProps(record):null)||
{};map.set(index,record);("checked"in record||"defaultChecked"in record)&&(0,_devWarning["default"])(!1,"Table","Do not set `checked` or `defaultChecked` in `getCheckboxProps`. Please use `selectedRowKeys` instead.")});return map},[flattedData,getRowKey,getCheckboxProps]),isCheckboxDisabled=(0,React.useCallback)(function(r){var _a;return!(null===(_a=checkboxPropsMap.get(getRowKey(r)))||void 0===_a||!_a.disabled)},[checkboxPropsMap,getRowKey]);config=(0,React.useMemo)(function(){if(checkStrictly)return[mergedSelectedKeys||
[],[]];var _conductCheck=(0,_conductUtil.conductCheck)(mergedSelectedKeys,!0,keyEntities,isCheckboxDisabled);return[_conductCheck.checkedKeys||[],_conductCheck.halfCheckedKeys]},[mergedSelectedKeys,checkStrictly,keyEntities,isCheckboxDisabled]);config=(0,_slicedToArray2["default"])(config,2);var derivedSelectedKeys=config[0],derivedHalfSelectedKeys=config[1],derivedSelectedKeySet=(0,React.useMemo)(function(){var keys="radio"===selectionType?derivedSelectedKeys.slice(0,1):derivedSelectedKeys;return new Set(keys)},
[derivedSelectedKeys,selectionType]),derivedHalfSelectedKeySet=(0,React.useMemo)(function(){return"radio"===selectionType?new Set:new Set(derivedHalfSelectedKeys)},[derivedHalfSelectedKeys,selectionType]);config=(0,React.useState)(null);config=(0,_slicedToArray2["default"])(config,2);var lastSelectedKey=config[0],setLastSelectedKey=config[1];React.useEffect(function(){rowSelection||setMergedSelectedKeys([])},[!!rowSelection]);var setSelectedKeys=(0,React.useCallback)(function(keys){if(preserveSelectedRowKeys){var newCache=
new Map;var availableKeys=keys;var records=keys.map(function(key){var record=getRecordByKey(key);!record&&preserveRecordsRef.current.has(key)&&(record=preserveRecordsRef.current.get(key));newCache.set(key,record);return record});preserveRecordsRef.current=newCache}else availableKeys=[],records=[],keys.forEach(function(key){var record=getRecordByKey(key);void 0!==record&&(availableKeys.push(key),records.push(record))});setMergedSelectedKeys(availableKeys);null===onSelectionChange||void 0===onSelectionChange?
void 0:onSelectionChange(availableKeys,records)},[setMergedSelectedKeys,getRecordByKey,onSelectionChange,preserveSelectedRowKeys]),triggerSingleSelection=(0,React.useCallback)(function(key,selected,keys,event){if(onSelect){var rows=keys.map(function(k){return getRecordByKey(k)});onSelect(getRecordByKey(key),selected,rows,event)}setSelectedKeys(keys)},[onSelect,getRecordByKey,setSelectedKeys]),mergedSelections=(0,React.useMemo)(function(){return!selections||hideSelectAll?null:(!0===selections?[SELECTION_ALL,
SELECTION_INVERT,SELECTION_NONE]:selections).map(function(selection){return selection===SELECTION_ALL?{key:"all",text:tableLocale.selectionAll,onSelect:function(){setSelectedKeys(data.map(function(record,index){return getRowKey(record,index)}))}}:selection===SELECTION_INVERT?{key:"invert",text:tableLocale.selectInvert,onSelect:function(){var keySet=new Set(derivedSelectedKeySet);pageData.forEach(function(record,index){record=getRowKey(record,index);if(keySet.has(record))keySet["delete"](record);else keySet.add(record)});
var keys=Array.from(keySet);onSelectInvert&&((0,_devWarning["default"])(!1,"Table","`onSelectInvert` will be removed in future. Please use `onChange` instead."),onSelectInvert(keys));setSelectedKeys(keys)}}:selection===SELECTION_NONE?{key:"none",text:tableLocale.selectNone,onSelect:function(){null===onSelectNone||void 0===onSelectNone?void 0:onSelectNone();setSelectedKeys([])}}:selection})},[selections,derivedSelectedKeySet,pageData,getRowKey,onSelectInvert,setSelectedKeys]);return[(0,React.useCallback)(function(columns){if(!rowSelection)return columns;
var keySet=new Set(derivedSelectedKeySet),recordKeys=flattedData.map(getRowKey).filter(function(key){return!checkboxPropsMap.get(key).disabled}),checkedCurrentAll=recordKeys.every(function(key){return keySet.has(key)}),checkedCurrentSome=recordKeys.some(function(key){return keySet.has(key)}),onSelectAllChange=function(){var changeKeys=[];checkedCurrentAll?recordKeys.forEach(function(key){keySet["delete"](key);changeKeys.push(key)}):recordKeys.forEach(function(key){keySet.has(key)||(keySet.add(key),
changeKeys.push(key))});var keys=Array.from(keySet);null===onSelectAll||void 0===onSelectAll?void 0:onSelectAll(!checkedCurrentAll,keys.map(function(k){return getRecordByKey(k)}),changeKeys.map(function(k){return getRecordByKey(k)}));setSelectedKeys(keys)};if("radio"!==selectionType){if(mergedSelections){var customizeSelections=React.createElement(_menu["default"],{getPopupContainer:getPopupContainer},mergedSelections.map(function(selection,index){var onSelectionClick=selection.onSelect;return React.createElement(_menu["default"].Item,
{key:selection.key||index,onClick:function(){null===onSelectionClick||void 0===onSelectionClick?void 0:onSelectionClick(recordKeys)}},selection.text)}));customizeSelections=React.createElement("div",{className:"".concat(prefixCls,"-selection-extra")},React.createElement(_dropdown["default"],{overlay:customizeSelections,getPopupContainer:getPopupContainer},React.createElement("span",null,React.createElement(_DownOutlined["default"],null))))}var title=flattedData.every(function(record,index){record=
getRowKey(record,index);return(checkboxPropsMap.get(record)||{}).disabled});title=!hideSelectAll&&React.createElement("div",{className:"".concat(prefixCls,"-selection")},React.createElement(_checkbox["default"],{checked:!title&&!!flattedData.length&&checkedCurrentAll,indeterminate:!checkedCurrentAll&&checkedCurrentSome,onChange:onSelectAllChange,disabled:0===flattedData.length||title,skipGroup:!0}),customizeSelections)}var renderCell="radio"===selectionType?function(_,record,index){var key=getRowKey(record,
index);_=keySet.has(key);return{node:React.createElement(_radio["default"],(0,_extends2["default"])({},checkboxPropsMap.get(key),{checked:_,onClick:function(e){return e.stopPropagation()},onChange:function(event){keySet.has(key)||triggerSingleSelection(key,!0,[key],event.nativeEvent)}})),checked:_}}:function(_,record,index){var _a,key=getRowKey(record,index),checked=keySet.has(key);record=derivedHalfSelectedKeySet.has(key);_=checkboxPropsMap.get(key);"nest"===expandType?(0,_devWarning["default"])("boolean"!==
typeof(null===_||void 0===_?void 0:_.indeterminate),"Table","set `indeterminate` using `rowSelection.getCheckboxProps` is not allowed with tree structured dataSource."):record=null!==(_a=null===_||void 0===_?void 0:_.indeterminate)&&void 0!==_a?_a:record;return{node:React.createElement(_checkbox["default"],(0,_extends2["default"])({},_,{indeterminate:record,checked:checked,skipGroup:!0,onClick:function(e){return e.stopPropagation()},onChange:function(_ref2){_ref2=_ref2.nativeEvent;var startIndex=
-1,endIndex=-1;if(_ref2.shiftKey&&checkStrictly){var pointKeys=new Set([lastSelectedKey,key]);recordKeys.some(function(recordKey,recordIndex){if(pointKeys.has(recordKey))if(-1===startIndex)startIndex=recordIndex;else return endIndex=recordIndex,!0;return!1})}if(-1!==endIndex&&startIndex!==endIndex&&checkStrictly){_ref2=recordKeys.slice(startIndex,endIndex+1);var changedKeys=[];checked?_ref2.forEach(function(recordKey){keySet.has(recordKey)&&(changedKeys.push(recordKey),keySet["delete"](recordKey))}):
_ref2.forEach(function(recordKey){keySet.has(recordKey)||(changedKeys.push(recordKey),keySet.add(recordKey))});_ref2=Array.from(keySet);null===onSelectMultiple||void 0===onSelectMultiple?void 0:onSelectMultiple(!checked,_ref2.map(function(recordKey){return getRecordByKey(recordKey)}),changedKeys.map(function(recordKey){return getRecordByKey(recordKey)}));setSelectedKeys(_ref2)}else if(checkStrictly){var checkedKeys=checked?(0,_util.arrDel)(derivedSelectedKeys,key):(0,_util.arrAdd)(derivedSelectedKeys,
key);triggerSingleSelection(key,!checked,checkedKeys,_ref2)}else{var result=(0,_conductUtil.conductCheck)([].concat((0,_toConsumableArray2["default"])(derivedSelectedKeys),[key]),!0,keyEntities,isCheckboxDisabled);checkedKeys=result.checkedKeys;result=result.halfCheckedKeys;var nextCheckedKeys=checkedKeys;checked&&(checkedKeys=new Set(checkedKeys),checkedKeys["delete"](key),nextCheckedKeys=(0,_conductUtil.conductCheck)(Array.from(checkedKeys),{checked:!1,halfCheckedKeys:result},keyEntities,isCheckboxDisabled).checkedKeys);
triggerSingleSelection(key,!checked,nextCheckedKeys,_ref2)}setLastSelectedKey(key)}})),checked:checked}};checkedCurrentSome=(0,_defineProperty2["default"])({width:selectionColWidth,className:"".concat(prefixCls,"-selection-column"),title:rowSelection.columnTitle||title,render:function(_,record,index){var _renderCell=renderCell(_,record,index);_=_renderCell.node;_renderCell=_renderCell.checked;return customizeRenderCell?customizeRenderCell(_renderCell,record,index,_):_}},_rcTable.INTERNAL_COL_DEFINE,
{className:"".concat(prefixCls,"-selection-col")});if("row"===expandType&&columns.length&&!expandIconColumnIndex){onSelectAllChange=(0,_toArray2["default"])(columns);columns=onSelectAllChange[0];onSelectAllChange=onSelectAllChange.slice(1);if(customizeSelections=fixed||getFixedType(onSelectAllChange[0]))columns.fixed=customizeSelections;return[columns,(0,_extends2["default"])((0,_extends2["default"])({},checkedCurrentSome),{fixed:customizeSelections})].concat((0,_toConsumableArray2["default"])(onSelectAllChange))}return[(0,
_extends2["default"])((0,_extends2["default"])({},checkedCurrentSome),{fixed:fixed||getFixedType(columns[0])})].concat((0,_toConsumableArray2["default"])(columns))},[getRowKey,flattedData,rowSelection,derivedSelectedKeys,derivedSelectedKeySet,derivedHalfSelectedKeySet,selectionColWidth,mergedSelections,expandType,lastSelectedKey,checkboxPropsMap,onSelectMultiple,triggerSingleSelection,isCheckboxDisabled]),derivedSelectedKeySet]};exports.SELECTION_NONE=exports.SELECTION_INVERT=exports.SELECTION_ALL=
void 0;var _toArray2=module(require("module$node_modules$$babel$runtime$helpers$toArray")),_defineProperty2=module(require("module$node_modules$$babel$runtime$helpers$defineProperty")),_extends2=module(require("module$node_modules$$babel$runtime$helpers$extends")),_slicedToArray2=module(require("module$node_modules$$babel$runtime$helpers$slicedToArray")),_toConsumableArray2=module(require("module$node_modules$$babel$runtime$helpers$toConsumableArray")),_typeof2=module(require("module$node_modules$$babel$runtime$helpers$typeof")),
React=global(require("module$node_modules$react$index")),_DownOutlined=module(require("module$node_modules$$ant_design$icons$DownOutlined")),_treeUtil=require("module$node_modules$rc_tree$lib$utils$treeUtil"),_conductUtil=require("module$node_modules$rc_tree$lib$utils$conductUtil"),_util=require("module$node_modules$rc_tree$lib$util"),_rcTable=require("module$node_modules$rc_table$lib$index"),_useMergedState3=module(require("module$node_modules$rc_util$lib$hooks$useMergedState")),_checkbox=module(require("module$node_modules$antd$lib$checkbox$index")),
_dropdown=module(require("module$node_modules$antd$lib$dropdown$index")),_menu=module(require("module$node_modules$antd$lib$menu$index")),_radio=module(require("module$node_modules$antd$lib$radio$index")),_devWarning=module(require("module$node_modules$antd$lib$_util$devWarning")),SELECTION_ALL="SELECT_ALL";exports.SELECTION_ALL=SELECTION_ALL;var SELECTION_INVERT="SELECT_INVERT";exports.SELECTION_INVERT=SELECTION_INVERT;var SELECTION_NONE="SELECT_NONE";exports.SELECTION_NONE=SELECTION_NONE}
//# sourceMappingURL=module$node_modules$antd$lib$table$hooks$useSelection.js.map
