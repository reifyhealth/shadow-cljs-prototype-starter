shadow$provide.module$node_modules$rc_field_form$lib$utils$validateUtil=function(global,require,module,exports){function replaceMessage(template,kv){return template.replace(/\$\{\w+\}/g,function(str){str=str.slice(2,-1);return kv[str]})}function convertMessages(messages,name,rule,messageVariables){function fillTemplate(source){var target=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Object.keys(source).forEach(function(ruleName){var value=source[ruleName];"string"===typeof value?target[ruleName]=
replaceFunc(value,messageVariables):value&&"object"===(0,_typeof2.default)(value)?(target[ruleName]={},fillTemplate(value,target[ruleName])):target[ruleName]=value});return target}var kv=(0,_objectSpread2.default)((0,_objectSpread2.default)({},rule),{},{name:name,enum:(rule.enum||[]).join(", ")}),replaceFunc=function(template,additionalKV){return function(){return replaceMessage(template,(0,_objectSpread2.default)((0,_objectSpread2.default)({},kv),additionalKV))}};return fillTemplate((0,_valueUtil.setValues)({},
_messages.defaultValidateMessages,messages))}function validateRule(_x,_x2,_x3,_x4,_x5){return _validateRule.apply(this,arguments)}function _validateRule(){_validateRule=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function _callee2(name,value,rule,options,messageVariables){var cloneRule,subRuleField,validator,messages,result,subResults;return _regenerator.default.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return cloneRule=(0,_objectSpread2.default)({},
rule),subRuleField=null,cloneRule&&"array"===cloneRule.type&&cloneRule.defaultField&&(subRuleField=cloneRule.defaultField,delete cloneRule.defaultField),validator=new AsyncValidator((0,_defineProperty2.default)({},name,[cloneRule])),messages=convertMessages(options.validateMessages,name,cloneRule,messageVariables),validator.messages(messages),result=[],_context2.prev=7,_context2.next=10,Promise.resolve(validator.validate((0,_defineProperty2.default)({},name,value),(0,_objectSpread2.default)({},options)));
case 10:_context2.next=15;break;case 12:_context2.prev=12,_context2.t0=_context2["catch"](7),_context2.t0.errors?result=_context2.t0.errors.map(function(_ref2,index){_ref2=_ref2.message;return React.isValidElement(_ref2)?React.cloneElement(_ref2,{key:"error_".concat(index)}):_ref2}):(console.error(_context2.t0),result=[messages.default()]);case 15:if(result.length||!subRuleField){_context2.next=20;break}_context2.next=18;return Promise.all(value.map(function(subValue,i){return validateRule("".concat(name,
".").concat(i),subValue,subRuleField,options,messageVariables)}));case 18:return subResults=_context2.sent,_context2.abrupt("return",subResults.reduce(function(prev,errors){return[].concat((0,_toConsumableArray2.default)(prev),(0,_toConsumableArray2.default)(errors))},[]));case 20:return _context2.abrupt("return",result);case 21:case "end":return _context2.stop()}},_callee2,null,[[7,12]])}));return _validateRule.apply(this,arguments)}function finishOnAllFailed(_x8){return _finishOnAllFailed.apply(this,
arguments)}function _finishOnAllFailed(){_finishOnAllFailed=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function _callee3(rulePromises){return _regenerator.default.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.abrupt("return",Promise.all(rulePromises).then(function(errorsList){var _ref3;return(_ref3=[]).concat.apply(_ref3,(0,_toConsumableArray2.default)(errorsList))}));case 1:case "end":return _context3.stop()}},_callee3)}));return _finishOnAllFailed.apply(this,
arguments)}function finishOnFirstFailed(_x9){return _finishOnFirstFailed.apply(this,arguments)}function _finishOnFirstFailed(){_finishOnFirstFailed=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function _callee4(rulePromises){var count;return _regenerator.default.wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return count=0,_context4.abrupt("return",new Promise(function(resolve){rulePromises.forEach(function(promise){promise.then(function(errors){errors.length&&
resolve(errors);count+=1;count===rulePromises.length&&resolve([])})})}));case 2:case "end":return _context4.stop()}},_callee4)}));return _finishOnFirstFailed.apply(this,arguments)}global=require("module$node_modules$$babel$runtime$helpers$interopRequireWildcard");module=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports.validateRules=function(namePath,value,rules,options,validateFirst,messageVariables){var name=
namePath.join("."),filledRules=rules.map(function(currentRule){var originValidatorFunc=currentRule.validator;return originValidatorFunc?(0,_objectSpread2.default)((0,_objectSpread2.default)({},currentRule),{},{validator:function(rule,val,callback){var hasPromise=!1;hasPromise=(rule=originValidatorFunc(rule,val,function(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];Promise.resolve().then(function(){(0,_warning.default)(!hasPromise,"Your validator function has already return a promise. `callback` will be ignored.");
hasPromise||callback.apply(void 0,args)})}))&&"function"===typeof rule.then&&"function"===typeof rule.catch;(0,_warning.default)(hasPromise,"`callback` is deprecated. Please return a promise instead.");hasPromise&&rule.then(function(){callback()}).catch(function(err){callback(err||" ")})}}):currentRule});!0===validateFirst?validateFirst=new Promise(function(){var _ref=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function _callee(resolve,reject){var i,errors;return _regenerator.default.wrap(function(_context){for(;;)switch(_context.prev=
_context.next){case 0:i=0;case 1:if(!(i<filledRules.length)){_context.next=11;break}_context.next=4;return validateRule(name,value,filledRules[i],options,messageVariables);case 4:errors=_context.sent;if(!errors.length){_context.next=8;break}reject(errors);return _context.abrupt("return");case 8:i+=1;_context.next=1;break;case 11:resolve([]);case 12:case "end":return _context.stop()}},_callee)}));return function(_x6,_x7){return _ref.apply(this,arguments)}}()):(namePath=filledRules.map(function(rule){return validateRule(name,
value,rule,options,messageVariables)}),validateFirst=(validateFirst?finishOnFirstFailed(namePath):finishOnAllFailed(namePath)).then(function(errors){return errors.length?Promise.reject(errors):[]}));validateFirst.catch(function(e){return e});return validateFirst};var _toConsumableArray2=module(require("module$node_modules$$babel$runtime$helpers$toConsumableArray")),_defineProperty2=module(require("module$node_modules$$babel$runtime$helpers$defineProperty")),_regenerator=module(require("module$node_modules$$babel$runtime$regenerator$index")),
_asyncToGenerator2=module(require("module$node_modules$$babel$runtime$helpers$asyncToGenerator")),_typeof2=module(require("module$node_modules$$babel$runtime$helpers$typeof")),_objectSpread2=module(require("module$node_modules$$babel$runtime$helpers$objectSpread2"));exports=module(require("module$node_modules$async_validator$dist_node$index"));var React=global(require("module$node_modules$react$index")),_warning=module(require("module$node_modules$rc_util$lib$warning")),_valueUtil=require("module$node_modules$rc_field_form$lib$utils$valueUtil"),
_messages=require("module$node_modules$rc_field_form$lib$utils$messages"),AsyncValidator=exports.default}
//# sourceMappingURL=module$node_modules$rc_field_form$lib$utils$validateUtil.js.map
