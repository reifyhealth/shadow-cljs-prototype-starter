shadow$provide.module$node_modules$rc_mentions$lib$Mentions=function(global,require,module,exports){global=require("module$node_modules$$babel$runtime$helpers$interopRequireWildcard");module=require("module$node_modules$$babel$runtime$helpers$interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0});exports.default=void 0;var _objectWithoutProperties2=module(require("module$node_modules$$babel$runtime$helpers$objectWithoutProperties")),_objectSpread2=module(require("module$node_modules$$babel$runtime$helpers$objectSpread2")),
_classCallCheck2=module(require("module$node_modules$$babel$runtime$helpers$classCallCheck")),_createClass2=module(require("module$node_modules$$babel$runtime$helpers$createClass")),_inherits2=module(require("module$node_modules$$babel$runtime$helpers$inherits")),_createSuper2=module(require("module$node_modules$$babel$runtime$helpers$createSuper")),_classnames=module(require("module$node_modules$classnames$index")),_toArray=module(require("module$node_modules$rc_util$lib$Children$toArray")),_KeyCode=
module(require("module$node_modules$rc_util$lib$KeyCode")),React=global(require("module$node_modules$react$index")),_rcTextarea=module(require("module$node_modules$rc_textarea$lib$index")),_KeywordTrigger=module(require("module$node_modules$rc_mentions$lib$KeywordTrigger")),_MentionsContext=require("module$node_modules$rc_mentions$lib$MentionsContext");global=module(require("module$node_modules$rc_mentions$lib$Option"));var _util=require("module$node_modules$rc_mentions$lib$util");require=function(_React$Component){function Mentions(props$jscomp$0){(0,
_classCallCheck2.default)(this,Mentions);var _this=_super.call(this,props$jscomp$0);_this.focusId=void 0;_this.triggerChange=function(value){var onChange=_this.props.onChange;"value"in _this.props||_this.setState({value:value});onChange&&onChange(value)};_this.onChange=function(_ref){_this.triggerChange(_ref.target.value)};_this.onKeyDown=function(event){var which=event.which,_this$state=_this.state,activeIndex=_this$state.activeIndex;_this$state.measuring&&(which===_KeyCode.default.UP||which===_KeyCode.default.DOWN?
(_this$state=_this.getOptions().length,_this.setState({activeIndex:(activeIndex+(which===_KeyCode.default.UP?-1:1)+_this$state)%_this$state}),event.preventDefault()):which===_KeyCode.default.ESC?_this.stopMeasure():which===_KeyCode.default.ENTER&&(event.preventDefault(),event=_this.getOptions(),event.length?_this.selectOption(event[activeIndex]):_this.stopMeasure()))};_this.onKeyUp=function(event){var key=event.key,which=event.which,_this$state2=_this.state,prevMeasureText=_this$state2.measureText;
_this$state2=_this$state2.measuring;var _this$props=_this.props,_this$props$prefix=_this$props.prefix,prefix=void 0===_this$props$prefix?"":_this$props$prefix;_this$props$prefix=_this$props.onSearch;_this$props=_this$props.validateSearch;event=event.target;var selectionStartText=(0,_util.getBeforeSelectionText)(event);prefix=(0,_util.getLastMeasureIndex)(selectionStartText,prefix);event=prefix.location;prefix=prefix.prefix;-1===[_KeyCode.default.ESC,_KeyCode.default.UP,_KeyCode.default.DOWN,_KeyCode.default.ENTER].indexOf(which)&&
(-1!==event?(which=selectionStartText.slice(event+prefix.length),_this$props=_this$props(which,_this.props),selectionStartText=!!_this.getOptions(which).length,_this$props?(key===prefix||"Shift"===key||_this$state2||which!==prevMeasureText&&selectionStartText)&&_this.startMeasure(which,prefix,event):_this$state2&&_this.stopMeasure(),_this$props$prefix&&_this$props&&_this$props$prefix(which,prefix)):_this$state2&&_this.stopMeasure())};_this.onPressEnter=function(event){var onPressEnter=_this.props.onPressEnter;
!_this.state.measuring&&onPressEnter&&onPressEnter(event)};_this.onInputFocus=function(event){_this.onFocus(event)};_this.onInputBlur=function(event){_this.onBlur(event)};_this.onDropdownFocus=function(){_this.onFocus()};_this.onDropdownBlur=function(){_this.onBlur()};_this.onFocus=function(event){window.clearTimeout(_this.focusId);var onFocus=_this.props.onFocus;!_this.state.isFocus&&event&&onFocus&&onFocus(event);_this.setState({isFocus:!0})};_this.onBlur=function(event){_this.focusId=window.setTimeout(function(){var onBlur=
_this.props.onBlur;_this.setState({isFocus:!1});_this.stopMeasure();onBlur&&onBlur(event)},0)};_this.selectOption=function(option){var _this$state3=_this.state,value=_this$state3.value,measureLocation=_this$state3.measureLocation;_this$state3=_this$state3.measurePrefix;var _this$props2=_this.props,split=_this$props2.split;_this$props2=_this$props2.onSelect;var _option$value=option.value;_option$value=void 0===_option$value?"":_option$value;value=(0,_util.replaceWithMeasure)(value,{measureLocation:measureLocation,
targetText:_option$value,prefix:_this$state3,selectionStart:_this.textarea.selectionStart,split:split});var selectionLocation=value.selectionLocation;_this.triggerChange(value.text);_this.stopMeasure(function(){(0,_util.setInputSelection)(_this.textarea,selectionLocation)});_this$props2&&_this$props2(option,_this$state3)};_this.setActiveIndex=function(activeIndex){_this.setState({activeIndex:activeIndex})};_this.setTextAreaRef=function(element){var _element$resizableTex;_this.textarea=null===element||
void 0===element?void 0:null===(_element$resizableTex=element.resizableTextArea)||void 0===_element$resizableTex?void 0:_element$resizableTex.textArea};_this.setMeasureRef=function(element){_this.measure=element};_this.getOptions=function(measureText){var targetMeasureText=measureText||_this.state.measureText||"";measureText=_this.props;var children=measureText.children,filterOption=measureText.filterOption;return(0,_toArray.default)(children).map(function(_ref2){var props=_ref2.props;_ref2=_ref2.key;
return(0,_objectSpread2.default)((0,_objectSpread2.default)({},props),{},{key:_ref2||props.value})}).filter(function(option){return!1===filterOption?!0:filterOption(targetMeasureText,option)})};_this.state={value:props$jscomp$0.defaultValue||props$jscomp$0.value||"",measuring:!1,measureLocation:0,measureText:null,measurePrefix:"",activeIndex:0,isFocus:!1};return _this}(0,_inherits2.default)(Mentions,_React$Component);var _super=(0,_createSuper2.default)(Mentions);(0,_createClass2.default)(Mentions,
[{key:"componentDidUpdate",value:function(){this.state.measuring&&(this.measure.scrollTop=this.textarea.scrollTop)}},{key:"startMeasure",value:function(measureText,measurePrefix,measureLocation){this.setState({measuring:!0,measureText:measureText,measurePrefix:measurePrefix,measureLocation:measureLocation,activeIndex:0})}},{key:"stopMeasure",value:function(callback){this.setState({measuring:!1,measureLocation:0,measureText:null},callback)}},{key:"focus",value:function(){this.textarea.focus()}},{key:"blur",
value:function(){this.textarea.blur()}},{key:"render",value:function(){var _this$state4=this.state,value=_this$state4.value,measureLocation=_this$state4.measureLocation,measurePrefix=_this$state4.measurePrefix,measuring=_this$state4.measuring;_this$state4=_this$state4.activeIndex;var _this$props4=this.props,prefixCls=_this$props4.prefixCls,placement=_this$props4.placement,direction=_this$props4.direction,transitionName=_this$props4.transitionName,className=_this$props4.className,style=_this$props4.style,
autoFocus=_this$props4.autoFocus,notFoundContent=_this$props4.notFoundContent,getPopupContainer=_this$props4.getPopupContainer;_this$props4=(0,_objectWithoutProperties2.default)(_this$props4,"prefixCls placement direction transitionName className style autoFocus notFoundContent getPopupContainer".split(" "));_this$props4=(0,_util.omit)(_this$props4,"value","defaultValue","prefix","split","children","validateSearch","filterOption","onSelect","onSearch");var options=measuring?this.getOptions():[];return React.createElement("div",
{className:(0,_classnames.default)(prefixCls,className),style:style},React.createElement(_rcTextarea.default,Object.assign({autoFocus:autoFocus,ref:this.setTextAreaRef,value:value},_this$props4,{onChange:this.onChange,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,onPressEnter:this.onPressEnter,onFocus:this.onInputFocus,onBlur:this.onInputBlur})),measuring&&React.createElement("div",{ref:this.setMeasureRef,className:"".concat(prefixCls,"-measure")},value.slice(0,measureLocation),React.createElement(_MentionsContext.MentionsContextProvider,
{value:{notFoundContent:notFoundContent,activeIndex:_this$state4,setActiveIndex:this.setActiveIndex,selectOption:this.selectOption,onFocus:this.onDropdownFocus,onBlur:this.onDropdownBlur}},React.createElement(_KeywordTrigger.default,{prefixCls:prefixCls,transitionName:transitionName,placement:placement,direction:direction,options:options,visible:!0,getPopupContainer:getPopupContainer},React.createElement("span",null,measurePrefix))),value.slice(measureLocation+measurePrefix.length)))}}],[{key:"getDerivedStateFromProps",
value:function(props,prevState){var newState={};"value"in props&&props.value!==prevState.value&&(newState.value=props.value||"");return newState}}]);return Mentions}(React.Component);require.Option=global.default;require.defaultProps={prefixCls:"rc-mentions",prefix:"@",split:" ",validateSearch:_util.validateSearch,filterOption:_util.filterOption,notFoundContent:"Not Found",rows:1};exports.default=require}
//# sourceMappingURL=module$node_modules$rc_mentions$lib$Mentions.js.map
