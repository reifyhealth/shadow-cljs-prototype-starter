shadow$provide.module$node_modules$async_validator$dist_node$index=function(global,require,module,exports){function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i],key;for(key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target};return _extends.apply(this,arguments)}function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype);subClass.prototype.constructor=
subClass;subClass.__proto__=superClass}function _getPrototypeOf(o$jscomp$0){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o$jscomp$0)}function _setPrototypeOf(o$jscomp$0,p$jscomp$0){_setPrototypeOf=Object.setPrototypeOf||function(o,p){o.__proto__=p;return o};return _setPrototypeOf(o$jscomp$0,p$jscomp$0)}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;
if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _construct(Parent,args$jscomp$0,Class$jscomp$0){_construct=_isNativeReflectConstruct()?Reflect.construct:function(Parent,args,Class){var a=[null];a.push.apply(a,args);Parent=new (Function.bind.apply(Parent,a));Class&&_setPrototypeOf(Parent,Class.prototype);return Parent};return _construct.apply(null,arguments)}function _wrapNativeSuper(Class$jscomp$0){var _cache=
"function"===typeof Map?new Map:void 0;_wrapNativeSuper=function(Class){function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}if(null===Class||-1===Function.toString.call(Class).indexOf("[native code]"))return Class;if("function"!==typeof Class)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof _cache){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}Wrapper.prototype=Object.create(Class.prototype,
{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}});return _setPrototypeOf(Wrapper,Class)};return _wrapNativeSuper(Class$jscomp$0)}function convertFieldsError(errors){if(!errors||!errors.length)return null;var fields={};errors.forEach(function(error){var field=error.field;fields[field]=fields[field]||[];fields[field].push(error)});return fields}function format(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var i=1;_len=args[0];
var len=args.length;return"function"===typeof _len?_len.apply(null,args.slice(1)):"string"===typeof _len?String(_len).replace(formatRegExp,function(x){if("%%"===x)return"%";if(i>=len)return x;switch(x){case "%s":return String(args[i++]);case "%d":return Number(args[i++]);case "%j":try{return JSON.stringify(args[i++])}catch(_){return"[Circular]"}default:return x}}):_len}function isEmptyValue(value,type){return void 0===value||null===value||"array"===type&&Array.isArray(value)&&!value.length||("string"===
type||"url"===type||"hex"===type||"email"===type||"date"===type||"pattern"===type)&&"string"===typeof value&&!value?!0:!1}function asyncParallelArray(arr,func,callback){function count(errors){results.push.apply(results,errors);total++;total===arrLength&&callback(results)}var results=[],total=0,arrLength=arr.length;arr.forEach(function(a){func(a,count)})}function asyncSerialArray(arr,func,callback){function next(errors){errors&&errors.length?callback(errors):(errors=index,index+=1,errors<arrLength?
func(arr[errors],next):callback([]))}var index=0,arrLength=arr.length;next([])}function flattenObjArr(objArr){var ret=[];Object.keys(objArr).forEach(function(k){ret.push.apply(ret,objArr[k])});return ret}function asyncMap(objArr,option,func,callback){if(option.first)return option=new Promise(function(resolve,reject){var flattenArr=flattenObjArr(objArr);asyncSerialArray(flattenArr,func,function(errors){callback(errors);return errors.length?reject(new AsyncValidationError(errors,convertFieldsError(errors))):
resolve()})}),option["catch"](function(e){return e}),option;var firstFields=option.firstFields||[];!0===firstFields&&(firstFields=Object.keys(objArr));var objArrKeys=Object.keys(objArr),objArrLength=objArrKeys.length,total=0,results=[];option=new Promise(function(resolve,reject){var next=function(errors){results.push.apply(results,errors);total++;if(total===objArrLength)return callback(results),results.length?reject(new AsyncValidationError(results,convertFieldsError(results))):resolve()};objArrKeys.length||
(callback(results),resolve());objArrKeys.forEach(function(key){var arr=objArr[key];-1!==firstFields.indexOf(key)?asyncSerialArray(arr,func,next):asyncParallelArray(arr,func,next)})});option["catch"](function(e){return e});return option}function complementError(rule){return function(oe){return oe&&oe.message?(oe.field=oe.field||rule.fullField,oe):{message:"function"===typeof oe?oe():oe,field:oe.field||rule.fullField}}}function deepMerge(target,source){if(source)for(var s in source)if(source.hasOwnProperty(s)){var value=
source[s];target[s]="object"===typeof value&&"object"===typeof target[s]?_extends(_extends({},target[s]),value):value}return target}function required(rule,value,source,errors,options,type){!rule.required||source.hasOwnProperty(rule.field)&&!isEmptyValue(value,type||rule.type)||errors.push(format(options.messages.required,rule.fullField))}function type$1(rule,value,callback,source,options){var ruleType=rule.type,errors=[];if(rule.required||!rule.required&&source.hasOwnProperty(rule.field)){if(isEmptyValue(value,
ruleType)&&!rule.required)return callback();rules.required(rule,value,source,errors,options,ruleType);isEmptyValue(value,ruleType)||rules.type(rule,value,source,errors,options)}callback(errors)}function newMessages(){return{"default":"Validation error on field %s",required:"%s is required","enum":"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",
method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s","boolean":"%s is not a %s",integer:"%s is not an %s","float":"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},
number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var cloned=JSON.parse(JSON.stringify(this));cloned.clone=this.clone;return cloned}}}function Schema(descriptor){this.rules=
null;this._messages=messages;this.define(descriptor)}global=require("module$node_modules$process$browser");"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var formatRegExp=/%[sdj%]/g;require=function(){};"undefined"!==typeof global&&global.env&&"undefined"!==typeof window&&"undefined"!==typeof document&&(require=function(type,errors){"undefined"!==typeof console&&console.warn&&errors.every(function(e){return"string"===typeof e})&&console.warn(type,errors)});var AsyncValidationError=
function(_Error){function AsyncValidationError(errors,fields){var _this=_Error.call(this,"Async Validation Error")||this;_this.errors=errors;_this.fields=fields;return _this}_inheritsLoose(AsyncValidationError,_Error);return AsyncValidationError}(_wrapNativeSuper(Error)),JSCompiler_object_inline_email_1944=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,JSCompiler_object_inline_url_1945=/^(?!mailto:)(?:(?:http|https|ftp):\/\/|\/\/)(?:\S+(?::\S*)?@)?(?:(?:(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[0-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))|localhost)(?::\d{2,5})?(?:(\/|\?|#)[^\s]*)?$/i,
JSCompiler_object_inline_hex_1946=/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i,types={integer:function(value){return types.number(value)&&parseInt(value,10)===value},"float":function(value){return types.number(value)&&!types.integer(value)},array:function(value){return Array.isArray(value)},regexp:function(value){return!0},date:function(value){return"function"===typeof value.getTime&&"function"===typeof value.getMonth&&"function"===typeof value.getYear&&!isNaN(value.getTime())},number:function(value){return isNaN(value)?
!1:"number"===typeof value},object:function(value){return"object"===typeof value&&!types.array(value)},method:function(value){return"function"===typeof value},email:function(value){return"string"===typeof value&&!!value.match(JSCompiler_object_inline_email_1944)&&255>value.length},url:function(value){return"string"===typeof value&&!!value.match(JSCompiler_object_inline_url_1945)},hex:function(value){return"string"===typeof value&&!!value.match(JSCompiler_object_inline_hex_1946)}},rules={required:required,
whitespace:function(rule,value,source,errors,options){(/^\s+$/.test(value)||""===value)&&errors.push(format(options.messages.whitespace,rule.fullField))},type:function(rule,value,source,errors,options){rule.required&&void 0===value?required(rule,value,source,errors,options):(source=rule.type,-1<"integer float array regexp object method email number date url hex".split(" ").indexOf(source)?types[source](value)||errors.push(format(options.messages.types[source],rule.fullField,rule.type)):source&&typeof value!==
rule.type&&errors.push(format(options.messages.types[source],rule.fullField,rule.type)))},range:function(rule,value,source,errors,options){source="number"===typeof rule.len;var min="number"===typeof rule.min,max="number"===typeof rule.max,spRegexp=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,val=value,key=null,num="number"===typeof value,str="string"===typeof value,arr=Array.isArray(value);num?key="number":str?key="string":arr&&(key="array");if(!key)return!1;arr&&(val=value.length);str&&(val=value.replace(spRegexp,
"_").length);source?val!==rule.len&&errors.push(format(options.messages[key].len,rule.fullField,rule.len)):min&&!max&&val<rule.min?errors.push(format(options.messages[key].min,rule.fullField,rule.min)):max&&!min&&val>rule.max?errors.push(format(options.messages[key].max,rule.fullField,rule.max)):min&&max&&(val<rule.min||val>rule.max)&&errors.push(format(options.messages[key].range,rule.fullField,rule.min,rule.max))},"enum":function(rule,value,source,errors,options){rule["enum"]=Array.isArray(rule["enum"])?
rule["enum"]:[];-1===rule["enum"].indexOf(value)&&errors.push(format(options.messages["enum"],rule.fullField,rule["enum"].join(", ")))},pattern:function(rule,value,source,errors,options){rule.pattern&&(rule.pattern instanceof RegExp?(rule.pattern.lastIndex=0,rule.pattern.test(value)||errors.push(format(options.messages.pattern.mismatch,rule.fullField,value,rule.pattern))):"string"===typeof rule.pattern&&((new RegExp(rule.pattern)).test(value)||errors.push(format(options.messages.pattern.mismatch,
rule.fullField,value,rule.pattern))))}},validators={string:function(rule,value,callback,source,options){var errors=[];if(rule.required||!rule.required&&source.hasOwnProperty(rule.field)){if(isEmptyValue(value,"string")&&!rule.required)return callback();rules.required(rule,value,source,errors,options,"string");isEmptyValue(value,"string")||(rules.type(rule,value,source,errors,options),rules.range(rule,value,source,errors,options),rules.pattern(rule,value,source,errors,options),!0===rule.whitespace&&
rules.whitespace(rule,value,source,errors,options))}callback(errors)},method:function(rule,value,callback,source,options){var errors=[];if(rule.required||!rule.required&&source.hasOwnProperty(rule.field)){if(isEmptyValue(value)&&!rule.required)return callback();rules.required(rule,value,source,errors,options);void 0!==value&&rules.type(rule,value,source,errors,options)}callback(errors)},number:function(rule,value,callback,source,options){var errors=[];if(rule.required||!rule.required&&source.hasOwnProperty(rule.field)){""===
value&&(value=void 0);if(isEmptyValue(value)&&!rule.required)return callback();rules.required(rule,value,source,errors,options);void 0!==value&&(rules.type(rule,value,source,errors,options),rules.range(rule,value,source,errors,options))}callback(errors)},"boolean":function(rule,value,callback,source,options){var errors=[];if(rule.required||!rule.required&&source.hasOwnProperty(rule.field)){if(isEmptyValue(value)&&!rule.required)return callback();rules.required(rule,value,source,errors,options);void 0!==
value&&rules.type(rule,value,source,errors,options)}callback(errors)},regexp:function(rule,value,callback,source,options){var errors=[];if(rule.required||!rule.required&&source.hasOwnProperty(rule.field)){if(isEmptyValue(value)&&!rule.required)return callback();rules.required(rule,value,source,errors,options);isEmptyValue(value)||rules.type(rule,value,source,errors,options)}callback(errors)},integer:function(rule,value,callback,source,options){var errors=[];if(rule.required||!rule.required&&source.hasOwnProperty(rule.field)){if(isEmptyValue(value)&&
!rule.required)return callback();rules.required(rule,value,source,errors,options);void 0!==value&&(rules.type(rule,value,source,errors,options),rules.range(rule,value,source,errors,options))}callback(errors)},"float":function(rule,value,callback,source,options){var errors=[];if(rule.required||!rule.required&&source.hasOwnProperty(rule.field)){if(isEmptyValue(value)&&!rule.required)return callback();rules.required(rule,value,source,errors,options);void 0!==value&&(rules.type(rule,value,source,errors,
options),rules.range(rule,value,source,errors,options))}callback(errors)},array:function(rule,value,callback,source,options){var errors=[];if(rule.required||!rule.required&&source.hasOwnProperty(rule.field)){if((void 0===value||null===value)&&!rule.required)return callback();rules.required(rule,value,source,errors,options,"array");void 0!==value&&null!==value&&(rules.type(rule,value,source,errors,options),rules.range(rule,value,source,errors,options))}callback(errors)},object:function(rule,value,
callback,source,options){var errors=[];if(rule.required||!rule.required&&source.hasOwnProperty(rule.field)){if(isEmptyValue(value)&&!rule.required)return callback();rules.required(rule,value,source,errors,options);void 0!==value&&rules.type(rule,value,source,errors,options)}callback(errors)},"enum":function(rule,value,callback,source,options){var errors=[];if(rule.required||!rule.required&&source.hasOwnProperty(rule.field)){if(isEmptyValue(value)&&!rule.required)return callback();rules.required(rule,
value,source,errors,options);if(void 0!==value)rules["enum"](rule,value,source,errors,options)}callback(errors)},pattern:function(rule,value,callback,source,options){var errors=[];if(rule.required||!rule.required&&source.hasOwnProperty(rule.field)){if(isEmptyValue(value,"string")&&!rule.required)return callback();rules.required(rule,value,source,errors,options);isEmptyValue(value,"string")||rules.pattern(rule,value,source,errors,options)}callback(errors)},date:function(rule,value,callback,source,
options){var errors=[];if(rule.required||!rule.required&&source.hasOwnProperty(rule.field)){if(isEmptyValue(value,"date")&&!rule.required)return callback();rules.required(rule,value,source,errors,options);isEmptyValue(value,"date")||(value=value instanceof Date?value:new Date(value),rules.type(rule,value,source,errors,options),value&&rules.range(rule,value.getTime(),source,errors,options))}callback(errors)},url:type$1,hex:type$1,email:type$1,required:function(rule,value,callback,source,options){var errors=
[],type=Array.isArray(value)?"array":typeof value;rules.required(rule,value,source,errors,options,type);callback(errors)},any:function(rule,value,callback,source,options){var errors=[];if(rule.required||!rule.required&&source.hasOwnProperty(rule.field)){if(isEmptyValue(value)&&!rule.required)return callback();rules.required(rule,value,source,errors,options)}callback(errors)}},messages=newMessages();Schema.prototype={messages:function(_messages){_messages&&(this._messages=deepMerge(newMessages(),_messages));
return this._messages},define:function(rules){if(!rules)throw Error("Cannot configure a schema with no rules");if("object"!==typeof rules||Array.isArray(rules))throw Error("Rules must be an object");this.rules={};var z;for(z in rules)if(rules.hasOwnProperty(z)){var item=rules[z];this.rules[z]=Array.isArray(item)?item:[item]}},validate:function(source_,o,oc){var _this=this;void 0===o&&(o={});void 0===oc&&(oc=function(){});var source=source_,options=o,callback=oc;"function"===typeof options&&(callback=
options,options={});if(!this.rules||0===Object.keys(this.rules).length)return callback&&callback(),Promise.resolve();options.messages?(o=this.messages(),o===messages&&(o=newMessages()),deepMerge(o,options.messages),options.messages=o):options.messages=this.messages();var arr,value,series={};(options.keys||Object.keys(this.rules)).forEach(function(z){arr=_this.rules[z];value=source[z];arr.forEach(function(r){"function"===typeof r.transform&&(source===source_&&(source=_extends({},source)),value=source[z]=
r.transform(value));r="function"===typeof r?{validator:r}:_extends({},r);r.validator=_this.getValidationMethod(r);r.field=z;r.fullField=r.fullField||z;r.type=_this.getType(r);r.validator&&(series[z]=series[z]||[],series[z].push({rule:r,value:value,source:source,field:z}))})});return asyncMap(series,options,function(data,doIt){function addFullfield(key,schema){return _extends(_extends({},schema),{},{fullField:rule.fullField+"."+key})}function cb(e){void 0===e&&(e=[]);var errors=e;Array.isArray(errors)||
(errors=[errors]);!options.suppressWarning&&errors.length&&Schema.warning("async-validator:",errors);errors.length&&void 0!==rule.message&&(errors=[].concat(rule.message));errors=errors.map(complementError(rule));if(options.first&&errors.length)return doIt(errors);if(deep){if(rule.required&&!data.value)return void 0!==rule.message?errors=[].concat(rule.message).map(complementError(rule)):options.error&&(errors=[options.error(rule,format(options.messages.required,rule.field))]),doIt(errors);e={};if(rule.defaultField)for(var k in data.value)data.value.hasOwnProperty(k)&&
(e[k]=rule.defaultField);e=_extends(_extends({},e),data.rule.fields);for(var f in e)e.hasOwnProperty(f)&&(k=Array.isArray(e[f])?e[f]:[e[f]],e[f]=k.map(addFullfield.bind(null,f)));f=new Schema(e);f.messages(options.messages);data.rule.options&&(data.rule.options.messages=options.messages,data.rule.options.error=options.error);f.validate(data.value,data.rule.options||options,function(errs){var finalErrors=[];errors&&errors.length&&finalErrors.push.apply(finalErrors,errors);errs&&errs.length&&finalErrors.push.apply(finalErrors,
errs);doIt(finalErrors.length?finalErrors:null)})}else doIt(errors)}var rule=data.rule,deep=("object"===rule.type||"array"===rule.type)&&("object"===typeof rule.fields||"object"===typeof rule.defaultField);deep=deep&&(rule.required||!rule.required&&data.value);rule.field=data.field;if(rule.asyncValidator)var res=rule.asyncValidator(rule,data.value,cb,data.source,options);else rule.validator&&(res=rule.validator(rule,data.value,cb,data.source,options),!0===res?cb():!1===res?cb(rule.message||rule.field+
" fails"):res instanceof Array?cb(res):res instanceof Error&&cb(res.message));res&&res.then&&res.then(function(){return cb()},function(e){return cb(e)})},function(results){var i,errors=[];for(i=0;i<results.length;i++){var _errors=void 0,e=results[i];Array.isArray(e)?errors=(_errors=errors).concat.apply(_errors,e):errors.push(e)}results=errors.length?convertFieldsError(errors):errors=null;callback(errors,results)})},getType:function(rule){void 0===rule.type&&rule.pattern instanceof RegExp&&(rule.type=
"pattern");if("function"!==typeof rule.validator&&rule.type&&!validators.hasOwnProperty(rule.type))throw Error(format("Unknown rule type %s",rule.type));return rule.type||"string"},getValidationMethod:function(rule){if("function"===typeof rule.validator)return rule.validator;var keys=Object.keys(rule),messageIndex=keys.indexOf("message");-1!==messageIndex&&keys.splice(messageIndex,1);return 1===keys.length&&"required"===keys[0]?validators.required:validators[this.getType(rule)]||!1}};Schema.register=
function(type,validator){if("function"!==typeof validator)throw Error("Cannot register a validator by type, validator is not a function");validators[type]=validator};Schema.warning=require;Schema.messages=messages;Schema.validators=validators;exports.default=Schema}
//# sourceMappingURL=module$node_modules$async_validator$dist_node$index.js.map
